-- [[ –º–µ–Ω—è–π —ç—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ ]]
getgenv().Optimization = {
    state = true, -- –≤–∫–ª/–≤—ã–∫–ª
    hide_screen = true, -- –≤—ã–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ—Ä–∏—Å–æ–≤–∫—É –≥—Ä–∞—Ñ–∏–∫–∏, –±—É—Å—Ç–∏—Ç –∂–µ—Å—Ç–æ—á–∞–π—à–µ —Ñ–ø—Å (–≤–∫–ª/–≤—ã–∫–ª)
    fps = 5
};

if getgenv().Optimization.state then
    if setfpscap ~= nil then setfpscap(getgenv().Optimization.fps); end
    UserSettings().GameSettings.MasterVolume = 0;
    settings().Rendering.QualityLevel = "Level01";
    game:GetService("RunService"):Set3dRenderingEnabled(not getgenv().Optimization.hide_screen);
end

local players = game:GetService("Players");
local local_player = players.LocalPlayer;
local rifts = workspace:FindFirstChild("Rendered"):FindFirstChild("Rifts");
local whitelisted_eggs = { -- —Ç–µ–ø–µ—Ä—å —Ç—É—Ç –º–µ–Ω—è–µ—à—å –≤–µ–±—Ö—É–∫–∏ –ù–ê –ö–ê–ñ–î–û–ï –Ø–ô–¶–û/–°–£–ù–î–£–ö, –≤ luck —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é –≤ –∫–∞–≤—ã—á–∫–∞—Ö –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ—à—å –º–Ω–æ–∂–∏—Ç–µ–ª—å —É–¥–∞—á–∏
    ["rainbow-egg"] = {
        webhook = "https://discord.com/api/webhooks/1369680016367161465/ytWtBI3H3EKVrjifey0KMsJ05wEtuy1cdMV7EvJ5OX6cb128k36s17sS8EYM7pCXkxkg",
        role_id = 0,
        luck = { "x25" },
        name = "Rainbow Egg"
    },
    ["nightmare-egg"] = {
        webhook = "https://discord.com/api/webhooks/1369679913308655828/es2UQtG9m_FY_aYotNaVKpFNwDXj0IOakFJg3g8lQ107fAHPJWoUqvU_1_RLEpCGUmIJ",
        role_id = 0,
        luck = { "x25" },
        name = "Nightmare Egg"
    },
    ["void-egg"] = {
        webhook = "https://discord.com/api/webhooks/1369680094322364446/vkkzcYcVY30Tb-D2MRZMrQbR3d2U_0YCdevjgPR2QTaEjFcFs8b7uZbEi-C5u60Bum6N",
        role_id = 0,
        luck = { "x25" },
        name = "Void Egg"
    },
    ["royal-chest"] = {
        webhook = "https://discord.com/api/webhooks/1369320116969541702/217cjweQ3Aga1IwwBzClwuNpe2KoXRKOq2IJMCV9sgzlEpd9iYHH2UJ89IT4qq8smumE",
        role_id = 0,
        name = "Royal Chest"
    },
    ["bubble-rift"] = {
        webhook = "https://discord.com/api/webhooks/1369680404487077958/pNTDbV_qBHqzTKXrxagTlqMyFgc13qmtRha8ca1Fkn9AdlnFgjT977lDU9A8Tavw1Ju9",
        role_id = 0,
        name = "Bubble Rift"
    },
    ["silly-egg"] = {
        webhook = "https://discord.com/api/webhooks/1369679726079250556/x9d_fCkwW-oLKaBE1yQxGenYnkVt3n_HgolUed6-xLRyVvh5MQED22AX8beYs4mSnwud",
        role_id = 0,
        luck = { "x10" },
        name = "Silly Egg"
    },
    ["mining-egg"] = {
        webhook = "https://discord.com/api/webhooks/1369680163113140354/KSzLYRiJMmYeeGOv4aSekxlVxrxihddZrvyJ_AfAtwDZsLCCYwXMvYq7HrEfP1N6tJjH",
        role_id = 0,
        luck = { "x25" },
        name = "Mining Egg"
    },
    ["cyber-egg"] = {
        webhook = "https://discord.com/api/webhooks/1369680252145504256/OEFlHbKAzOuz6kZ97gcgsNyDrBR6wMBNlwiaIXWVNTeXUM5yIDLPGstTawfPE4Lx6a6R",
        role_id = 0,
        luck = { "x25" },
        name = "Cyber Egg"
    },
    ["dice-rift"] = {
        webhook = "https://discord.com/api/webhooks/1369680321729138718/s6R5cyeB3k9sBAD4Akxaem86xzxW4-6lNWgs-V5P2TDH86pxWl7mT1Wwvs-XfN4O-GVS",
        role_id = 0,
        name = "Dice Rift"
    },
    ["underworld-1"] = {
        webhook = "https://discord.com/api/webhooks/1369680321729138718/s6R5cyeB3k9sBAD4Akxaem86xzxW4-6lNWgs-V5P2TDH86pxWl7mT1Wwvs-XfN4O-GVS",
        role_id = 0,
        luck = { "x25" },
        name = "Underworld 1"
    },
    ["underworld-2"] = {
        webhook = "https://discord.com/api/webhooks/1369680321729138718/s6R5cyeB3k9sBAD4Akxaem86xzxW4-6lNWgs-V5P2TDH86pxWl7mT1Wwvs-XfN4O-GVS",
        role_id = 0,
        luck = { "x25" },
        name = "Underworld 2"
    },
    ["underworld-3"] = {
        webhook = "https://discord.com/api/webhooks/1369680321729138718/s6R5cyeB3k9sBAD4Akxaem86xzxW4-6lNWgs-V5P2TDH86pxWl7mT1Wwvs-XfN4O-GVS",
        role_id = 0,
        luck = { "x25" },
        name = "Underworld 3"
    }
};
local spam_messages = {
    "Best Rift Finder = ƒ£ƒ£/ easyriftüöÄ",
    "Silly Egg is found! ƒ£ƒ£/ easyriftü•ö",
    "Best Pet Shop = ƒ£ƒ£/ easyriftüê∂",
    "REACH THE LEADERBOARDS USING ƒüƒü/ easyriftüèÜ",
    "SECRETS GIVE-AWAY HAPPENING ƒ£ƒ£/ easyriftüê∂",
    "X25 LUCK RIFTS AT ƒ£ƒ£/ easyriftüçÄ",
    "GET SILLY EGG AT ƒ£ƒ£/ easyriftü•ö",
    "UNDERWORLD RIFT ƒ£ƒ£/ easyriftü•ö"
};

local join_code = string.format('game.TeleportService:TeleportToPlaceInstance(%d, "%s", game.Players.LocalPlayer)', game.PlaceId, game.JobId);
local join_link = string.format('https://www.roblox.com/games/start?placeId=16302670534&launchData=%d/%s', game.PlaceId, game.JobId);

local parse_time = function(text)
    text = string.lower(string.gsub(text, "^%s*(.-)%s*$", "%1"));
    local number, unit = string.match(text, "(%d+)%s*(%a+)");
    if number == nil or unit == nil then 
        return 0;
    end
    
    number = tonumber(number);
    
    if string.find(unit, "second") then
        return number;
    elseif string.find(unit, "minute") then
        return number * 60;
    elseif string.find(unit, "hour") then
        return number * 3600;
    else
        return 0;
    end
end

local time_to_discorddate = function(time_)
    return string.format("<t:%d:R>", time_);
end

local request = (syn ~= nil and syn.request) or (http ~= nil and http.request) or (fluxus ~= nil and fluxus.request) or http_request or request;
local notify = function(webhook, data)
    return request({Url = webhook, Body = game:GetService("HttpService"):JSONEncode(data), Method = "POST", Headers = { ['content-type'] = "application/json" }});
end

-- –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —Å–º–µ–Ω—ã —Å–µ—Ä–≤–µ—Ä–∞
local lastServerHopTime = tick()

local serverhop = function()
    print("Attempting server hop...")
    
    -- –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ–≥–æ –≤—ã–∑–æ–≤–∞
    if tick() - lastServerHopTime < 10 then
        print("Server hop attempted too soon, cancelling")
        return false
    end
    
    lastServerHopTime = tick()
    
    local req = request({
        Url = string.format("https://games.roblox.com/v1/games/%d/servers/Public?sortOrder=Desc&limit=100&excludeFullGames=true", game.PlaceId)
    })
    
    local success, body = pcall(function()
        return game:GetService("HttpService"):JSONDecode(req.Body)
    end)
    
    if success and body and body.data then
        local servers = {}
        
        for _, server in pairs(body.data) do
            if server.playing < server.maxPlayers and server.id ~= game.JobId then
                table.insert(servers, server)
            end
        end
        
        if #servers > 0 then
            print("Found servers: " .. #servers)
            local selectedServer = servers[math.random(1, #servers)]
            
            -- –ü–æ–ø—ã—Ç–∫–∞ —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏–∏ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
            local teleportSuccess, teleportError = pcall(function()
                game:GetService("TeleportService"):TeleportToPlaceInstance(game.PlaceId, selectedServer.id, local_player)
            end)
            
            if not teleportSuccess then
                print("Teleport failed: " .. tostring(teleportError))
                -- –ü—Ä–æ–±—É–µ–º –µ—â–µ —Ä–∞–∑ —Å –¥—Ä—É–≥–∏–º —Å–µ—Ä–≤–µ—Ä–æ–º
                if #servers > 1 then
                    local newIndex = math.random(1, #servers)
                    while servers[newIndex].id == selectedServer.id and #servers > 1 do
                        newIndex = math.random(1, #servers)
                    end
                    selectedServer = servers[newIndex]
                    
                    pcall(function()
                        game:GetService("TeleportService"):TeleportToPlaceInstance(game.PlaceId, selectedServer.id, local_player)
                    end)
                end
            end
            
            -- –î–∞–µ–º –≤—Ä–µ–º—è –Ω–∞ —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏—é
            wait(5)
            return true
        else
            print("No suitable servers found, teleporting to same place")
            pcall(function()
                game:GetService("TeleportService"):Teleport(game.PlaceId, local_player)
            end)
            wait(5)
            return true
        end
    else
        print("Failed to get server list, teleporting to same place")
        pcall(function()
            game:GetService("TeleportService"):Teleport(game.PlaceId, local_player)
        end)
        wait(5)
        return true
    end
    
    return false
end

-- –û—Ç–¥–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ–π —Å–º–µ–Ω—ã —Å–µ—Ä–≤–µ—Ä–æ–≤
task.spawn(function()
    -- –°–Ω–∞—á–∞–ª–∞ –¥–∞–µ–º –≤—Ä–µ–º—è –Ω–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ä–∏—Ñ—Ç–æ–≤
    wait(15)
    
    while true do
        print("Server hop cycle - waiting 15 seconds")
        wait(15)
        
        local hopResult = serverhop()
        
        -- –ï—Å–ª–∏ serverhop –Ω–µ —É–¥–∞–ª—Å—è, –ø—ã—Ç–∞–µ–º—Å—è —Å–Ω–æ–≤–∞ —á–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è
        if not hopResult then
            wait(5)
        end
    end
end)

task.spawn(function() -- anti afk (xz zachem, poidet)
    for _,v in pairs(getconnections(local_player.Idled)) do v:Disable() end
    for _,v in pairs(getconnections(game:GetService("UserInputService").WindowFocused)) do v:Disable() end
    for _,v in pairs(getconnections(game:GetService("UserInputService").WindowFocusReleased)) do v:Disable() end
end)

task.spawn(function()
    -- –ü–æ–ø—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –∫–∞–Ω–∞–ª —á–∞—Ç–∞ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
    local success, channel
    
    success, channel = pcall(function()
        return game:GetService("TextChatService"):WaitForChild("TextChannels", 5):WaitForChild("RBXGeneral", 5)
    end)
    
    if not success or not channel then
        print("–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –∫–∞–Ω–∞–ª —á–∞—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥")
        
        -- –ü–æ–ø—ã—Ç–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—É—é —Å–∏—Å—Ç–µ–º—É —á–∞—Ç–∞
        pcall(function()
            while task.wait(math.random(1, 6)) do
                local message = spam_messages[math.random(1, #spam_messages)]
                game:GetService("ReplicatedStorage").DefaultChatSystemChatEvents.SayMessageRequest:FireServer(message, "All")
            end
        end)
        return
    end
    
    local time = 1
    local randomGen = Random.new()
    
    while task.wait() do
        -- –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª
        local messageIndex = randomGen:NextInteger(1, #spam_messages)
        
        pcall(function()
            channel:SendAsync(spam_messages[messageIndex])
        end)
        
        time += 2
        if time > 6 then
            time = 1
        end

        task.wait(time)
    end
end)

do
    for _, rift in pairs(rifts:GetChildren()) do
        if not rift:IsA("Model") or not whitelisted_eggs[rift.Name] then
            continue
        end

        local data = whitelisted_eggs[rift.Name]
        local luck = "None"
        local gui
        
        pcall(function()
            gui = rift:FindFirstChild("Display"):FindFirstChildOfClass("SurfaceGui")
        end)
        
        if data.luck ~= nil then
            if gui == nil then
                pcall(function()
                    repeat task.wait(0.1) 
                        gui = rift:FindFirstChild("Display"):FindFirstChildOfClass("SurfaceGui")
                    until gui ~= nil or task.wait(5)
                end)
            end
            
            -- –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ GUI —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –∏–º–µ–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–æ—á–µ—Ä–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã
            if gui and gui:FindFirstChild("Icon") and gui.Icon:FindFirstChild("Luck") then
                if not table.find(data.luck, gui.Icon.Luck.Text) then
                    continue
                end

                luck = gui.Icon.Luck.Text
            else
                print("Rift GUI not properly loaded for: " .. rift.Name)
                continue
            end
        end

        -- –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ GUI
        if not gui or not gui:FindFirstChild("Timer") then
            print("Timer element not found for: " .. rift.Name)
            continue
        end

        local time = os.time() + parse_time(gui.Timer.Text)
        local discord_time = time_to_discorddate(time)
        local height = math.floor(rift:GetPivot().Position.Y) - 4
        local message = {
            ['content'] = string.format("<@%d>", data.role_id),
            ['embeds'] = {
                { 
                    ['title'] = string.format("**%s has been found!**", data.name), 
                    ['fields'] = {
                        {
                            ['name'] = "**‚è≤ Expires in**",
                            ['value'] = discord_time,
                            ['inline'] = true
                        },
                        {
                            ['name'] = "**üìè Height**",
                            ['value'] = string.format("`%d`", height),
                            ['inline'] = true
                        },
                        {
                            ['name'] = "**üë§ Players**",
                            ['value'] = string.format("`%d`", #players:GetPlayers()),
                            ['inline'] = true
                        },
                        {
                            ['name'] = "**üçÄ Luck**",
                            ['value'] = string.format("`%s`", luck)
                        },
                        {
                            ['name'] = "**üîó Join link**",
                            ['value'] = join_link
                        },
                        {
                            ['name'] = "**üë®‚Äçüíª Join script**",
                            ['value'] = string.format("```%s```", join_code)
                        }
                    },
                    ['color'] = 4508791,
                    ['timestamp'] = DateTime.now():ToIsoDate()
                }
            }
        }

        notify(data.webhook, message)
    end
end

game:GetService("CoreGui"):FindFirstChild("RobloxPromptGui"):FindFirstChild("promptOverlay").ChildAdded:Connect(function(child) -- –ø—Ä–∏ –∫–∏–∫–µ –∏–≥—Ä–æ–π
    print("Kick detected, server hopping...")
    serverhop()
end)
